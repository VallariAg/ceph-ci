os_type: centos
os_version: "8.2"
overrides:
  selinux:
    whitelist:
      - scontext=system_u:system_r:logrotate_t:s0

tasks:
- exec:
    all:
    - sudo dnf -y module disable container-tools
    - sudo dnf -y install 'dnf-command(copr)'
    - sudo dnf -y copr enable rhcontainerbot/container-selinux
    - sudo curl -L -o /etc/yum.repos.d/devel:kubic:libcontainers:testing.repo https://download.opensuse.org/repositories/devel:/kubic:/libcontainers:/testing/CentOS_8/devel:kubic:libcontainers:testing.repo
    - sudo dnf remove -y podman
    - sudo dnf -y install podman

- cephadm:
    image: docker.io/ceph/ceph:v15.2.5
    cephadm_branch: v15.2.5
    cephadm_git_url: https://github.com/ceph/ceph
    # avoid --cap-add=PTRACE + --privileged for older cephadm versions
    allow_ptrace: false
