meta:
- desc: configure the permissions for client.migrator
overrides:
  ceph:
    conf:
      client:
        rbd default features: 125
        debug rbd: 20
        log to stderr: false
      # override to make these names predictable
      client.migrator:
        admin socket: /var/run/ceph/rbd-migration.$cluster-$name.asok
        pid file: /var/run/ceph/rbd-migration.$cluster-$name.pid
tasks:
- exec:
    cluster2.client.migrator:
      - "sudo ceph --cluster cluster2 auth caps client.migrator mon 'profile rbd' osd 'profile rbd-read-only'"

